<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Concurrent Programming Course note 2 - TyrangYang_Blog</title><meta name="Description" content=""><meta property="og:title" content="Concurrent Programming Course note 2" />
<meta property="og:description" content="Race condition Multiple thread access one same variables of object concurrently and at least one does update.
Bad situation.
Atomic operation An operation is atomic if it execute until it completion without interruption
Critical section A part of program that accesses shared memory and which we which to execute automatically.
mutual exclusion problem (MEP)  Mutex: at and point in time, there is at most one thread in the critical section Absence of livelock: If various of threads try to entry the critical section, at lease one of them will succeed." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tyrangyang.github.io/TyrangYang_blog/concurrent-programming-2/" />
<meta property="article:published_time" content="2019-09-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-09-04T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Concurrent Programming Course note 2"/>
<meta name="twitter:description" content="Race condition Multiple thread access one same variables of object concurrently and at least one does update.
Bad situation.
Atomic operation An operation is atomic if it execute until it completion without interruption
Critical section A part of program that accesses shared memory and which we which to execute automatically.
mutual exclusion problem (MEP)  Mutex: at and point in time, there is at most one thread in the critical section Absence of livelock: If various of threads try to entry the critical section, at lease one of them will succeed."/>
<meta name="application-name" content="TyrangYang_Blog">
<meta name="apple-mobile-web-app-title" content="TyrangYang_Blog"><link rel="shortcut icon" type="image/x-icon" href="https://tyrangyang.github.io/TyrangYang_blog/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="https://tyrangyang.github.io/TyrangYang_blog/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://tyrangyang.github.io/TyrangYang_blog/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="https://tyrangyang.github.io/TyrangYang_blog/apple-touch-icon.png"><link rel="manifest" href="https://tyrangyang.github.io/TyrangYang_blog/site.webmanifest"><link rel="canonical" href="https://tyrangyang.github.io/TyrangYang_blog/concurrent-programming-2/" /><link rel="prev" href="https://tyrangyang.github.io/TyrangYang_blog/software-development-1/" /><link rel="next" href="https://tyrangyang.github.io/TyrangYang_blog/concurrent-programming-3/" /><link rel="stylesheet" href="https://tyrangyang.github.io/TyrangYang_blog/lib/normalize/normalize.min.css"><link rel="stylesheet" href="https://tyrangyang.github.io/TyrangYang_blog/css/style.min.css"><link rel="stylesheet" href="https://tyrangyang.github.io/TyrangYang_blog/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="https://tyrangyang.github.io/TyrangYang_blog/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Concurrent Programming Course note 2",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/tyrangyang.github.io\/TyrangYang_blog\/concurrent-programming-2\/"
        },"genre": "posts","keywords": "concurrent, course note","wordcount":  391 ,
        "url": "https:\/\/tyrangyang.github.io\/TyrangYang_blog\/concurrent-programming-2\/","datePublished": "2019-09-04T00:00:00+00:00","dateModified": "2019-09-04T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Haolin Yang"},"author": {
                "@type": "Person",
                "name": "Haolin Yang"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="https://tyrangyang.github.io/TyrangYang_blog/" title="TyrangYang_Blog">TyrangYang_Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="https://tyrangyang.github.io/TyrangYang_blog/posts/"><i class='fas fa-book-open'></i>  Posts </a><a class="menu-item" href="https://tyrangyang.github.io/TyrangYang_blog/tags/"><i class='fas fa-tags'></i>  Tags </a><a class="menu-item" href="https://tyrangyang.github.io/TyrangYang_blog/categories/"><i class='fab fa-buffer'></i>  Categories </a><a class="menu-item" href="https://github.com/TyrangYang/TyrangYang_blog" title="Blog github" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw fa-fw'></i>  </a><a class="menu-item" href="https://tyrangyang.github.io/" title="home page" rel="noopener noreffer" target="_blank"><i class="fas fa-home"></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="https://tyrangyang.github.io/TyrangYang_blog/" title="TyrangYang_Blog">TyrangYang_Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="https://tyrangyang.github.io/TyrangYang_blog/posts/" title=""><i class='fas fa-book-open'></i> Posts</a><a class="menu-item" href="https://tyrangyang.github.io/TyrangYang_blog/tags/" title=""><i class='fas fa-tags'></i> Tags</a><a class="menu-item" href="https://tyrangyang.github.io/TyrangYang_blog/categories/" title=""><i class='fab fa-buffer'></i> Categories</a><a class="menu-item" href="https://github.com/TyrangYang/TyrangYang_blog" title="Blog github" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw fa-fw'></i></a><a class="menu-item" href="https://tyrangyang.github.io/" title="home page" rel="noopener noreffer" target="_blank"><i class="fas fa-home"></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><article class="page single"><h1 class="single-title animated flipInX">Concurrent Programming Course note 2</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://tyrangyang.github.io/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Haolin Yang</a></span>&nbsp;<span class="post-category">included in <a href="https://tyrangyang.github.io/TyrangYang_blog/categories/concurrent-programming/"><i class="far fa-folder fa-fw"></i>Concurrent-programming</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2019-09-04">2019-09-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;391 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;2 minutes&nbsp;</div>
        </div><div class="content" id="content"><h2 id="race-condition">Race condition</h2>
<p>Multiple thread access one same variables of object concurrently and at least one does update.</p>
<p>Bad situation.</p>
<h2 id="atomic-operation">Atomic operation</h2>
<p>An operation is atomic if it execute until it completion without interruption</p>
<h2 id="critical-section">Critical section</h2>
<p>A part of program that accesses shared memory and which we which to execute automatically.</p>
<h3 id="mutual-exclusion-problem-mep">mutual exclusion problem (MEP)</h3>
<ol>
<li>Mutex: at and point in time, there is at most one thread in the critical section</li>
<li>Absence of livelock: If various of threads try to entry the critical section, at lease one of them will succeed.</li>
<li>Free from starvation: A thread trying to enter its critical section will eventually be able to do so.</li>
</ol>
<p><strong>Deadlock</strong> is not exit for a interleaving in a transition system.</p>
<p><strong>no shared variables between critical and non critical section nor with the entry/exit protocol.</strong></p>
<p>critical section must be end</p>
<p>it is meaningless that while(true) loop not exist.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">flag</span><span class="p">){</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="c1">// .....
</span><span class="c1"></span>    <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">await</span> <span class="o">!</span><span class="n">flag</span>
</code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="https://tyrangyang.github.io/TyrangYang_blog/svg/loading.min.svg"
        data-src="https://tyrangyang.github.io/TyrangYang_blog/images/2019-09-04-concurrent-programming-2/transition-system.png"
        data-srcset="https://tyrangyang.github.io/TyrangYang_blog/images/2019-09-04-concurrent-programming-2/transition-system.png, https://tyrangyang.github.io/TyrangYang_blog/images/2019-09-04-concurrent-programming-2/transition-system.png 1.5x, https://tyrangyang.github.io/TyrangYang_blog/images/2019-09-04-concurrent-programming-2/transition-system.png 2x"
        data-sizes="auto"
        alt="/images/2019-09-04-concurrent-programming-2/transition-system.png"
        title="transition system" /></p>
<p>no (p4,q4) which two thread in critical section at same time.</p>
<p>if process could block when trying to access the critical section, it is <strong>deadlock</strong>.</p>
<p><strong>Starvation</strong> is due to the fact that both processes test and set a single global variable.</p>
<h2 id="dekkers-algorithm">Dekker&rsquo;s Algorithm</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">global</span> <span class="kt">int</span> <span class="n">turn</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
<span class="n">global</span> <span class="kt">boolean</span> <span class="n">wantP</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="n">global</span> <span class="kt">boolean</span> <span class="n">wantQ</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

<span class="n">thread</span> <span class="n">p</span><span class="o">:{</span>
    <span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">){</span>
        <span class="n">wantP</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">while</span> <span class="n">wantQ</span><span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">turn</span> <span class="o">==</span> <span class="n">2</span><span class="o">){</span>
                <span class="n">wantP</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="n">await</span> <span class="o">(</span><span class="n">turn</span> <span class="o">==</span> <span class="n">1</span><span class="o">);</span>
                <span class="n">wantP</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">turn</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
        <span class="n">wantP</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">thread</span> <span class="n">p</span><span class="o">:{</span>
    <span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">){</span>
        <span class="n">wantQ</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">while</span> <span class="n">wantP</span><span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">turn</span> <span class="o">==</span> <span class="n">1</span><span class="o">){</span>
                <span class="n">wantQ</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="n">await</span> <span class="o">(</span><span class="n">turn</span> <span class="o">==</span> <span class="n">2</span><span class="o">);</span>
                <span class="n">wantQ</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">turn</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
        <span class="n">wantQ</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="petersons-algorithm">Peterson&rsquo;s Algorithm</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">global</span> <span class="kt">int</span> <span class="n">last</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
<span class="n">global</span> <span class="kt">boolean</span> <span class="n">wantP</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="n">global</span> <span class="kt">boolean</span> <span class="n">wantQ</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

<span class="n">thread</span> <span class="n">p</span><span class="o">:{</span>
    <span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">){</span>
        <span class="n">wantP</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
        <span class="n">await</span> <span class="o">(!</span><span class="n">wantQ</span> <span class="o">||</span> <span class="n">last</span> <span class="o">==</span> <span class="n">2</span><span class="o">);</span>
        <span class="n">wantP</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">){</span>
        <span class="n">wantQ</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">2</span><span class="o">;</span>
        <span class="n">await</span> <span class="o">(!</span><span class="n">wantP</span> <span class="o">||</span> <span class="n">last</span> <span class="o">==</span> <span class="n">1</span><span class="o">);</span>
        <span class="n">wantQ</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2019-09-04</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="https://tyrangyang.github.io/TyrangYang_blog/concurrent-programming-2/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="https://tyrangyang.github.io/TyrangYang_blog/tags/concurrent/">concurrent</a>,&nbsp;<a href="https://tyrangyang.github.io/TyrangYang_blog/tags/course-note/">course note</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="https://tyrangyang.github.io/TyrangYang_blog/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="https://tyrangyang.github.io/TyrangYang_blog/software-development-1/" class="prev" rel="prev" title="Software Development Course note"><i class="fas fa-angle-left fa-fw"></i>Software Development Course note</a>
            <a href="https://tyrangyang.github.io/TyrangYang_blog/concurrent-programming-3/" class="next" rel="next" title="Concurrent Programming Course note 3">Concurrent Programming Course note 3<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.69.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://tyrangyang.github.io/" target="_blank">Haolin Yang</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="https://tyrangyang.github.io/TyrangYang_blog/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="https://tyrangyang.github.io/TyrangYang_blog/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="https://tyrangyang.github.io/TyrangYang_blog/lib/algoliasearch/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://tyrangyang.github.io/TyrangYang_blog/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="https://tyrangyang.github.io/TyrangYang_blog/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":1000},"comment":{},"search":{"algoliaAppID":"QXEV52XWDS","algoliaIndex":"blog","algoliaSearchKey":"db56d05ebbeed337adca1ef261004dcc","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":null,"type":"algolia"}};</script><script type="text/javascript" src="https://tyrangyang.github.io/TyrangYang_blog/js/theme.min.js"></script></body>
</html>
